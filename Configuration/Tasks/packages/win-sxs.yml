---
title: Packages
description: Removes system (WinSxS) packages
privilege: TrustedInstaller
actions:

  # NOTE: !systemPackage: method of removing system packages is now deprecated and not recommended by Shuragen4ik, as it is one of the main cause of #49

  - !writeStatus: {status: "Removing system packages"}
  # Custom removal skipped

  # ============================================================================
  # === Windows Defender Options ===
  # ============================================================================
  # NOTE: All Defender-related operations are handled by CMD scripts
  # (Disable-Defender.cmd and Remove-Defender.cmd) which are executed from main.yml
  # Direct PowerShell/service operations fail due to Tamper Protection
  # ============================================================================

  # === Option: disable-defender - Отключить Защитник Windows ===
  - !writeStatus: {status: 'Windows Defender will be disabled via script...', option: 'disable-defender'}

  # === Option: remove-defender - Полностью удалить Защитник Windows ===
  - !writeStatus: {status: 'Windows Defender will be removed via script...', option: 'remove-defender'}

  # === Option: keep-defender - Оставить Защитник Windows как есть ===
  - !writeStatus: {status: 'Keeping Windows Defender as is...', option: 'keep-defender'}

  - !writeStatus: {status: "Removing AI components", option: 'remove-winsxs-ai'}
  # Custom removal skipped

  - !writeStatus: {status: "Removing OneDrive WinSxS", option: "remove-onedrive"}
  # Custom removal skipped
